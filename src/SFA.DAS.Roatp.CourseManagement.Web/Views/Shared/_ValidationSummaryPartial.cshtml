@using Microsoft.AspNetCore.Mvc.ModelBinding;
@model ModelStateDictionary

@if (!Model.IsValid)
{
    <div class="govuk-error-summary" role="alert" data-valmsg-summary="true" tabindex="-1">
        <h2 class="govuk-error-summary__title">
            There is a problem
        </h2>
        <div class="govuk-error-summary__body">
            <ul class="govuk-list govuk-error-summary__list">
                @foreach (var stateItem in Model.Where(msi => msi.Value.ValidationState == ModelValidationState.Invalid))
                {
                    var errorModel = new
                    {
                        ElementId = ViewData.TemplateInfo.GetFullHtmlFieldName(stateItem.Key) ?? stateItem.Key,
                        Message = stateItem.Value.Errors.FirstOrDefault()?.ErrorMessage
                    };
                    <li>
                        @if (!string.IsNullOrEmpty(errorModel.ElementId))
                        {
                            <a href="#@errorModel.ElementId" data-focuses="error-message-@errorModel.ElementId" class="summary-link">@errorModel.Message</a>
                        }
                        else
                        {
                            <span>@errorModel.Message</span>
                        }
                    </li>
                }
            </ul>
        </div>
    </div>
}